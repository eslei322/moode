<?php
/**
 * moOde audio player (C) 2014 Tim Curtis
 * http://moodeaudio.org
 *
 * This Program is free software; you can redistribute it and/or modify
 * it under the terms of the GNU General Public License as published by
 * the Free Software Foundation; either version 3, or (at your option)
 * any later version.
 *
 * This Program is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the
 * GNU General Public License for more details.
 *
 * You should have received a copy of the GNU General Public License
 * along with this program.  If not, see <http://www.gnu.org/licenses/>.
 *
 * 2020-04-24 TC moOde 6.5.0
 *
 */

require_once dirname(__FILE__).'/inc/playerlib.php';playerSession('open','','');if(isset($_POST['update_i2s_device'])){if(isset($_POST['i2sdevice'])){playerSession('write','i2sdevice',$_POST['i2sdevice']);$title='I2S 音频设备已更新';$msg='<b>系统需要重启</b><br>系统重新启动后检校 芯片/驱动 设置';submitJob('i2sdevice',$_POST['i2sdevice'],$title,$msg,30);}}if(isset($_POST['update_drvoptions'])){if(isset($_POST['drvoptions'])&&$_POST['drvoptions']!='none'){$result=sdbquery("SELECT driver, drvoptions FROM cfg_audiodev WHERE name='".$_SESSION['i2sdevice']."'",cfgdb_connect());$driver=explode(',',$result[0]['driver']);$driverupd=$_POST['drvoptions']=='Enabled'?$driver[0].','.$result[0]['drvoptions']:$driver[0];$result=sdbquery("UPDATE cfg_audiodev SET driver='".$driverupd."' WHERE name='".$_SESSION['i2sdevice']."'",cfgdb_connect());submitJob('i2sdevice',$_SESSION['i2sdevice'],'驱动已更新','系统需要重启');}}if(isset($_POST['update_alsavolume_max'])){if(isset($_POST['alsavolume_max'])){submitJob('alsavolume_max',$_POST['alsavolume_max'],'最大 ALSA 音量已更新','');playerSession('write','alsavolume_max',$_POST['alsavolume_max']);}}if(isset($_POST['update_mpdver'])&&$_POST['mpdver']!=$_SESSION['mpdver']){playerSession('write','mpdver',$_POST['mpdver']);submitJob('mpdver',$_POST['mpdver'],'MPD '.$_POST['mpdver'].' 已安装','数据库开始重建...');}if(isset($_POST['mpdrestart'])&&$_POST['mpdrestart']==1){submitJob('mpdrestart','','MPD 已重启','');}if(isset($_POST['ashufflesvc'])&&$_POST['ashufflesvc']!=$_SESSION['ashufflesvc']){$_SESSION['notify']['title']=$_POST['ashufflesvc']==1?'启用自动穿插':'停用自动穿插';$_SESSION['notify']['duration']=3;playerSession('write','ashufflesvc',$_POST['ashufflesvc']);$sock=openMpdSock('localhost',6600);sendMpdCmd($sock,'random 0');$resp=readMpdResp($sock);if($_POST['ashufflesvc']==0){sysCmd('killall -s 9 ashuffle > /dev/null');playerSession('write','ashuffle','0');sendMpdCmd($sock,'consume 0');$resp=readMpdResp($sock);}}if(isset($_POST['autoplay'])&&$_POST['autoplay']!=$_SESSION['autoplay']){$_SESSION['notify']['title']=$_POST['autoplay']==1?'启用开机自动回放':'停用开机自动回放';playerSession('write','autoplay',$_POST['autoplay']);}if(isset($_POST['update_rotenc'])){if(isset($_POST['rotenc_params'])&&$_POST['rotenc_params']!=$_SESSION['rotenc_params']){$title='转编码器参数已更新';playerSession('write','rotenc_params',$_POST['rotenc_params']);}if(isset($_POST['rotaryenc'])&&$_POST['rotaryenc']!=$_SESSION['rotaryenc']){$title=$_POST['rotaryenc']==1?'启用轮转编码器':'停用轮转编码器';playerSession('write','rotaryenc',$_POST['rotaryenc']);}if(isset($title)){submitJob('rotaryenc',$_POST['rotaryenc'],$title,'');}}if(isset($_POST['update_usb_volknob'])&&$_POST['usb_volknob']!=$_SESSION['usb_volknob']){$title=$_POST['usb_volknob']==1?'启用 USB 音量控制':'停用 USB 音量控制';submitJob('usb_volknob',$_POST['usb_volknob'],$title,'');playerSession('write','usb_volknob',$_POST['usb_volknob']);}if(isset($_POST['volume_step_limit'])&&$_POST['volume_step_limit']!=$_SESSION['volume_step_limit']){playerSession('write','volume_step_limit',$_POST['volume_step_limit']);$_SESSION['notify']['title']='设置已更新';}if(isset($_POST['volume_mpd_max'])&&$_POST['volume_mpd_max']!=$_SESSION['volume_mpd_max']){playerSession('write','volume_mpd_max',$_POST['volume_mpd_max']);$_SESSION['notify']['title']='设置已更新';}if(isset($_POST['update_invert_polarity'])&&$_POST['invert_polarity']!=$_SESSION['invert_polarity']){$title=$_POST['invert_polarity']==1?'启用反相极性':'停用反相极性';submitJob('invert_polarity',$_POST['invert_polarity'],$title,'');playerSession('write','invert_polarity',$_POST['invert_polarity']);}if(isset($_POST['mpdcrossfade'])&&$_POST['mpdcrossfade']!=$_SESSION['mpdcrossfade']){submitJob('mpdcrossfade',$_POST['mpdcrossfade'],'交叉渐变设置已更新','');playerSession('write','mpdcrossfade',$_POST['mpdcrossfade']);}if(isset($_POST['mpd_httpd'])&&$_POST['mpd_httpd']!=$_SESSION['mpd_httpd']){$title=$_POST['mpd_httpd']==1?'启用 HTTP 发送':'停用 HTTP 发送';submitJob('mpd_httpd',$_POST['mpd_httpd'],$title,'');playerSession('write','mpd_httpd',$_POST['mpd_httpd']);}if(isset($_POST['mpd_httpd_port'])&&$_POST['mpd_httpd_port']!=$_SESSION['mpd_httpd_port']){playerSession('write','mpd_httpd_port',$_POST['mpd_httpd_port']);submitJob('mpd_httpd_port',$_POST['mpd_httpd_port'],'HTTP 端口已更新','MPD 已重启');}if(isset($_POST['mpd_httpd_encoder'])&&$_POST['mpd_httpd_encoder']!=$_SESSION['mpd_httpd_encoder']){playerSession('write','mpd_httpd_encoder',$_POST['mpd_httpd_encoder']);submitJob('mpd_httpd_encoder',$_POST['mpd_httpd_encoder'],'HTTP 编码格式已更新','MPD 已重启');}if(isset($_POST['crossfeed'])&&$_POST['crossfeed']!=$_SESSION['crossfeed']){playerSession('write','crossfeed',$_POST['crossfeed']);submitJob('crossfeed',$_POST['crossfeed'],'交叉叠加 '.($_POST['crossfeed']=='Off'?'off':'on'),'');}if(isset($_POST['eqfa4p'])&&$_POST['eqfa4p']!=$_SESSION['eqfa4p']){playerSession('write','eqfa4p',$_POST['eqfa4p']);submitJob('eqfa4p',$_SESSION['eqfa4p'].','.$_POST['eqfa4p'],'参数均衡器 '.($_POST['eqfa4p']=='Off'?'off':'on'),'MPD 已重启');}if(isset($_POST['alsaequal'])&&$_POST['alsaequal']!=$_SESSION['alsaequal']){playerSession('write','alsaequal',$_POST['alsaequal']);submitJob('alsaequal',$_SESSION['alsaequal'].','.$_POST['alsaequal'],'图形均衡器 '.($_POST['alsaequal']=='Off'?'off':'on'),'');}if(isset($_POST['update_bt_settings'])){$currentBtName=$_SESSION['btname'];if(isset($_POST['btname'])&&$_POST['btname']!=$_SESSION['btname']){$title='蓝牙名称已更改';playerSession('write','btname',$_POST['btname']);}if(isset($_POST['btsvc'])&&$_POST['btsvc']!=$_SESSION['btsvc']){$title=$_POST['btsvc']==1?'启用蓝牙':'停用蓝牙';playerSession('write','btsvc',$_POST['btsvc']);if($_POST['btsvc']=='0'){playerSession('write','pairing_agent','0');}}if(isset($title)){submitJob('btsvc','"'.$currentBtName.'" '.'"'.$_POST['btname'].'"',$title,'');}}if(isset($_POST['update_pairing_agent'])){playerSession('write','pairing_agent',$_POST['pairing_agent']);submitJob('pairing_agent',$_POST['pairing_agent'],($_POST['pairing_agent']==1?'启用配对代理':'停用配对代理'),'');}if(isset($_POST['update_bt_multi'])){playerSession('write','btmulti',$_POST['btmulti']);submitJob('btmulti','',($_POST['btmulti']==1?'启用喇叭共享':'停用喇叭共享'),'');}if(isset($_POST['update_rsmafterbt'])){playerSession('write','rsmafterbt',$_POST['rsmafterbt']);$_SESSION['notify']['title']='设置已更新';}if(isset($_POST['btrestart'])&&$_POST['btrestart']==1&&$_SESSION['btsvc']=='1'){submitJob('btsvc','','蓝牙已重启','');}if(isset($_POST['update_airplay_settings'])){if(isset($_POST['airplayname'])&&$_POST['airplayname']!=$_SESSION['airplayname']){$title='Airplay name 已更新';playerSession('write','airplayname',$_POST['airplayname']);}if(isset($_POST['airplaysvc'])&&$_POST['airplaysvc']!=$_SESSION['airplaysvc']){$title=$_POST['airplaysvc']==1?'启用 Airplay 接收':'停用 Airplay 接收';playerSession('write','airplaysvc',$_POST['airplaysvc']);}if(isset($title)){submitJob('airplaysvc','',$title,'');}}if(isset($_POST['update_rsmafterapl'])){playerSession('write','rsmafterapl',$_POST['rsmafterapl']);$_SESSION['notify']['title']='设置已更新';}if(isset($_POST['airplayrestart'])&&$_POST['airplayrestart']==1&&$_SESSION['airplaysvc']=='1'){submitJob('airplaysvc','','Airplay 已重启','');}if(isset($_POST['update_spotify_settings'])){if(isset($_POST['spotifyname'])&&$_POST['spotifyname']!=$_SESSION['spotifyname']){$title='Spotify 名称已更新';playerSession('write','spotifyname',$_POST['spotifyname']);}if(isset($_POST['spotifysvc'])&&$_POST['spotifysvc']!=$_SESSION['spotifysvc']){$title=$_POST['spotifysvc']==1?'Spotify 接受receiver启用 on':'Spotify receiver 停用off';playerSession('write','spotifysvc',$_POST['spotifysvc']);}if(isset($title)){submitJob('spotifysvc','',$title,'');}}if(isset($_POST['update_rsmafterspot'])){playerSession('write','rsmafterspot',$_POST['rsmafterspot']);$_SESSION['notify']['title']='设置已更新';}if(isset($_POST['spotifyrestart'])&&$_POST['spotifyrestart']==1&&$_SESSION['spotifysvc']=='1'){submitJob('spotifysvc','','Spotify receiver 已重启','');}if(isset($_POST['spotify_clear_credentials'])&&$_POST['spotify_clear_credentials']==1){submitJob('spotify_clear_credentials','','Credential cache cleared','');}if(isset($_POST['update_sl_settings'])){if(isset($_POST['slsvc'])&&$_POST['slsvc']!=$_SESSION['slsvc']){$title=$_POST['slsvc']==1?'启用 Squeezelite':'停用 Squeezelite';playerSession('write','slsvc',$_POST['slsvc']);}if(isset($title)){submitJob('slsvc','',$title,'');}}if(isset($_POST['update_rsmaftersl'])){playerSession('write','rsmaftersl',$_POST['rsmaftersl']);$_SESSION['notify']['title']='设置已更新';}if(isset($_POST['slrestart'])&&$_POST['slrestart']==1){submitJob('slrestart','','Squeezelite 已重启','');}if(isset($_POST['update_upnp_settings'])){$currentUpnpName=$_SESSION['upnpname'];if(isset($_POST['upnpname'])&&$_POST['upnpname']!=$_SESSION['upnpname']){$title='UPnP name 已更新';playerSession('write','upnpname',$_POST['upnpname']);}if(isset($_POST['upnpsvc'])&&$_POST['upnpsvc']!=$_SESSION['upnpsvc']){$title=$_POST['upnpsvc']==1?'启用 UPnP':'停用 UPnP';playerSession('write','upnpsvc',$_POST['upnpsvc']);}if(isset($title)){submitJob('upnpsvc','"'.$currentUpnpName.'" '.'"'.$_POST['upnpname'].'"',$title,'');}}if(isset($_POST['upnprestart'])&&$_POST['upnprestart']==1&&$_SESSION['upnpsvc']=='1'){submitJob('upnpsvc','','UPnP 已重启','');}if(isset($_POST['update_dlna_settings'])){$currentDlnaName=$_SESSION['dlnaname'];if(isset($_POST['dlnaname'])&&$_POST['dlnaname']!=$_SESSION['dlnaname']){$title='DLNA 名称已更新';playerSession('write','dlnaname',$_POST['dlnaname']);}if(isset($_POST['dlnasvc'])&&$_POST['dlnasvc']!=$_SESSION['dlnasvc']){$title=$_POST['dlnasvc']==1?'启用 DLNA 服务器':'停用 DLNA 服务器';$msg=$_POST['dlnasvc']==1?'DB rebuild initiated':'';playerSession('write','dlnasvc',$_POST['dlnasvc']);}if(isset($title)){submitJob('minidlna','"'.$currentDlnaName.'" '.'"'.$_POST['dlnaname'].'"',$title,$msg);}}if(isset($_POST['rebuild_dlnadb'])){if($_SESSION['dlnasvc']==1){submitJob('dlnarebuild','','已开始 DB 重建','');}else{$_SESSION['notify']['title']='Turn DLNA server 启用on';$_SESSION['notify']['msg']='将要开始 DB 重建';}}if(isset($_POST['update_upnp_browser'])){if(isset($_POST['upnp_browser'])&&$_POST['upnp_browser']!=$_SESSION['upnp_browser']){$title=$_POST['upnp_browser']==1?'启用 UPnP 浏览器':'停用 UPnP 浏览器';playerSession('write','upnp_browser',$_POST['upnp_browser']);}if(isset($title)){submitJob('upnp_browser',$_POST['upnp_browser'],$title,'');}}if(isset($_POST['upnp_browser_restart'])&&$_POST['upnp_browser_restart']==1&&$_SESSION['upnp_browser']=='1'){submitJob('upnp_browser','','UPnP 浏览器已重启','');}if(isset($_POST['update_mpdas'])){if(isset($_POST['mpdasuser'])&&$_POST['mpdasuser']!=$_SESSION['mpdasuser']){$title="Scrobbler credentials 已更新";playerSession('write','mpdasuser',$_POST['mpdasuser']);}if(isset($_POST['mpdaspwd'])&&$_POST['mpdaspwd']!=$_SESSION['mpdaspwd']){$title="Scrobbler 凭证已更新";playerSession('write','mpdaspwd',$_POST['mpdaspwd']);}if(isset($_POST['mpdassvc'])&&$_POST['mpdassvc']!=$_SESSION['mpdassvc']){$title=$_POST['mpdassvc']==1?'启用 Audio Scrobbler':'停用 Audio Scrobbler 停用';playerSession('write','mpdassvc',$_POST['mpdassvc']);}if(isset($title)){submitJob('mpdassvc',$_POST['mpdassvc'],$title,'');}}session_write_close();$result=sdbquery("SELECT name FROM cfg_audiodev WHERE iface='I2S' AND list='yes'",cfgdb_connect());$array=array();$array[0]['name']='none';$dacList=array_merge($array,$result);foreach($dacList as $dac){$dacName=($dac['name']=='none')?'非 I2S':$dac['name'];$selected=($_SESSION['i2sdevice']==$dac['name'])?' selected':'';$_i2s['i2sdevice'].=sprintf('<option value="%s"%s>%s</option>\n',$dac['name'],$selected,$dacName);}$result=sdbquery("SELECT chipoptions, driver, drvoptions FROM cfg_audiodev WHERE name='".$_SESSION['i2sdevice']."'",cfgdb_connect());if(!empty($result[0]['drvoptions'])){$_select['drvoptions'].="<option value=\"Enabled\" ".((strpos($result[0]['driver'],$result[0]['drvoptions'])!==false)?"selected":"").">".$result[0]['drvoptions']." Enabled</option>\n";$_select['drvoptions'].="<option value=\"Disabled\" ".((strpos($result[0]['driver'],$result[0]['drvoptions'])===false)?"selected":"").">".$result[0]['drvoptions']." Disabled</option>\n";}else{$_select['drvoptions'].="<option value=\"none\" selected>无可用选项</option>\n";}$_chip_btn_disable=!empty($result[0]['chipoptions'])?'':'disabled';$_chip_link_disable=!empty($result[0]['chipoptions'])?'':'onclick="return false;"';if($_SESSION['alsavolume']=='none'){$_alsavolume_max='';$_alsavolume_max_readonly='readonly';$_alsavolume_hide='hide';$_alsavolume_msg="<span class=\"help-block-configs help-block-margin\">未有硬件音量控制设备</span>";}else{$_alsavolume_max=$_SESSION['alsavolume_max'];$_alsavolume_max_readonly='';$_alsavolume_max_hide='';$_alsavolume_max_msg='';}$_select['mpdver'].="<option value=\"0.21.22\" ".(($_SESSION['mpdver']=='0.21.22')?"selected":"").">0.21.22 ( 默认 )</option>\n";$_select['mpdver'].="<option value=\"0.22~git\" ".(($_SESSION['mpdver']=='0.22~git')?"selected":"").">0.22~git ( 试验 )</option>\n";$_select['ashufflesvc1'].="<input type=\"radio\" name=\"ashufflesvc\" id=\"toggleashufflesvc1\" value=\"1\" ".(($_SESSION['ashufflesvc']==1)?"checked=\"checked\"":"").">\n";$_select['ashufflesvc0'].="<input type=\"radio\" name=\"ashufflesvc\" id=\"toggleashufflesvc2\" value=\"0\" ".(($_SESSION['ashufflesvc']==0)?"checked=\"checked\"":"").">\n";$_select['autoplay1'].="<input type=\"radio\" name=\"autoplay\" id=\"toggleautoplay1\" value=\"1\" ".(($_SESSION['autoplay']==1)?"checked=\"checked\"":"").">\n";$_select['autoplay0'].="<input type=\"radio\" name=\"autoplay\" id=\"toggleautoplay2\" value=\"0\" ".(($_SESSION['autoplay']==0)?"checked=\"checked\"":"").">\n";$_select['rotaryenc1'].="<input type=\"radio\" name=\"rotaryenc\" id=\"togglerotaryenc1\" value=\"1\" ".(($_SESSION['rotaryenc']==1)?"checked=\"checked\"":"").">\n";$_select['rotaryenc0'].="<input type=\"radio\" name=\"rotaryenc\" id=\"togglerotaryenc2\" value=\"0\" ".(($_SESSION['rotaryenc']==0)?"checked=\"checked\"":"").">\n";$_select['rotenc_params']=$_SESSION['rotenc_params'];$_select['usb_volknob1'].="<input type=\"radio\" name=\"usb_volknob\" id=\"toggle_usb_volknob1\" value=\"1\" ".(($_SESSION['usb_volknob']==1)?"checked=\"checked\"":"").">\n";$_select['usb_volknob0'].="<input type=\"radio\" name=\"usb_volknob\" id=\"toggle_usb_volknob2\" value=\"0\" ".(($_SESSION['usb_volknob']==0)?"checked=\"checked\"":"").">\n";$_select['volume_step_limit'].="<option value=\"2\" ".(($_SESSION['volume_step_limit']=='2')?"selected":"").">2</option>\n";$_select['volume_step_limit'].="<option value=\"5\" ".(($_SESSION['volume_step_limit']=='5')?"selected":"").">5</option>\n";$_select['volume_step_limit'].="<option value=\"10\" ".(($_SESSION['volume_step_limit']=='10')?"selected":"").">10</option>\n";$_volume_mpd_max=$_SESSION['volume_mpd_max'];$_select['invert_polarity1'].="<input type=\"radio\" name=\"invert_polarity\" id=\"toggle_invert_polarity1\" value=\"1\" ".(($_SESSION['invert_polarity']==1)?"checked=\"checked\"":"").">\n";$_select['invert_polarity0'].="<input type=\"radio\" name=\"invert_polarity\" id=\"toggle_invert_polarity2\" value=\"0\" ".(($_SESSION['invert_polarity']==0)?"checked=\"checked\"":"").">\n";$_mpdcrossfade=$_SESSION['mpdcrossfade'];$_select['mpd_httpd1'].="<input type=\"radio\" name=\"mpd_httpd\" id=\"toggle-mpd-httpd1\" value=\"1\" ".(($_SESSION['mpd_httpd']==1)?"checked=\"checked\"":"").">\n";$_select['mpd_httpd0'].="<input type=\"radio\" name=\"mpd_httpd\" id=\"toggle-mpd-httpd2\" value=\"0\" ".(($_SESSION['mpd_httpd']==0)?"checked=\"checked\"":"").">\n";$_mpd_httpd_port=$_SESSION['mpd_httpd_port'];$_select['mpd_httpd_encoder'].="<option value=\"flac\" ".(($_SESSION['mpd_httpd_encoder']=='flac')?"selected":"").">FLAC</option>\n";$_select['mpd_httpd_encoder'].="<option value=\"lame\" ".(($_SESSION['mpd_httpd_encoder']=='lame')?"selected":"").">LAME (MP3)</option>\n";$_invpolarity_set_disabled=($_SESSION['crossfeed']!='Off'||$_SESSION['eqfa4p']!='Off'||$_SESSION['alsaequal']!='Off')?'disabled':'';$_crossfeed_set_disabled=($_SESSION['invert_polarity']!='0'||$_SESSION['eqfa4p']!='Off'||$_SESSION['alsaequal']!='Off')?'disabled':'';$_eqfa4p_set_disabled=($_SESSION['invert_polarity']!='0'||$_SESSION['crossfeed']!='Off'||$_SESSION['alsaequal']!='Off')?'disabled':'';$_alsaequal_set_disabled=($_SESSION['invert_polarity']!='0'||$_SESSION['crossfeed']!='Off'||$_SESSION['eqfa4p']!='Off')?'disabled':'';$_select['crossfeed'].="<option value=\"Off\" ".(($_SESSION['crossfeed']=='Off'OR $_SESSION['crossfeed']=='')?"selected":"").">停用</option>\n";if($_crossfeed_set_disabled==''){$_select['crossfeed'].="<option value=\"700 4.5\" ".(($_SESSION['crossfeed']=='700 4.5')?"selected":"").">700 Hz 4.5 dB</option>\n";$_select['crossfeed'].="<option value=\"700 6.0\" ".(($_SESSION['crossfeed']=='700 6.0')?"selected":"").">700 Hz 6.0 dB</option>\n";$_select['crossfeed'].="<option value=\"650 9.5\" ".(($_SESSION['crossfeed']=='650 9.5')?"selected":"").">650 Hz 9.5 dB</option>\n";}$result=sdbquery('SELECT curve_name FROM cfg_eqfa4p',cfgdb_connect());$array=array();$array[0]['curve_name']='Off';$curveList=$_eqfa4p_set_disabled==''?array_merge($array,$result):$array;foreach($curveList as $curve){$curveName=$curve['curve_name'];$selected=($_SESSION['eqfa4p']==$curve['curve_name'])?'selected':'';$_select['eqfa4p'].=sprintf('<option value="%s" %s>%s</option>\n',$curve['curve_name'],$selected,$curveName);}$result=sdbquery('SELECT curve_name FROM cfg_eqalsa',cfgdb_connect());$array=array();$array[0]['curve_name']='Off';$curveList=$_alsaequal_set_disabled==''?array_merge($array,$result):$array;foreach($curveList as $curve){$curveName=$curve['curve_name'];$selected=($_SESSION['alsaequal']==$curve['curve_name'])?'selected':'';$_select['alsaequal'].=sprintf('<option value="%s" %s>%s</option>\n',$curve['curve_name'],$selected,$curveName);}$_feat_bluetooth=$_SESSION['feat_bitmask']&FEAT_BLUETOOTH?'':'hide';$_SESSION['btsvc']=='1'?$_bt_btn_disable='':$_bt_btn_disable='disabled';$_SESSION['btsvc']=='1'?$_bt_link_disable='':$_bt_link_disable='onclick="return false;"';$_select['btsvc1'].="<input type=\"radio\" name=\"btsvc\" id=\"togglebtsvc1\" value=\"1\" ".(($_SESSION['btsvc']==1)?"checked=\"checked\"":"").">\n";$_select['btsvc0'].="<input type=\"radio\" name=\"btsvc\" id=\"togglebtsvc2\" value=\"0\" ".(($_SESSION['btsvc']==0)?"checked=\"checked\"":"").">\n";$_select['btname']=$_SESSION['btname'];$_select['pairing_agent1'].="<input type=\"radio\" name=\"pairing_agent\" id=\"toggle-pairing-agent1\" value=\"1\" ".(($_SESSION['pairing_agent']==1)?"checked=\"checked\"":"").">\n";$_select['pairing_agent0'].="<input type=\"radio\" name=\"pairing_agent\" id=\"toggle-pairing-agent2\" value=\"0\" ".(($_SESSION['pairing_agent']==0)?"checked=\"checked\"":"").">\n";$_select['btmulti1'].="<input type=\"radio\" name=\"btmulti\" id=\"togglebtmulti1\" value=\"1\" ".(($_SESSION['btmulti']==1)?"checked=\"checked\"":"").">\n";$_select['btmulti0'].="<input type=\"radio\" name=\"btmulti\" id=\"togglebtmulti2\" value=\"0\" ".(($_SESSION['btmulti']==0)?"checked=\"checked\"":"").">\n";$_select['rsmafterbt'].="<option value=\"1\" ".(($_SESSION['rsmafterbt']=='1')?"selected":"").">启用s</option>\n";$_select['rsmafterbt'].="<option value=\"0\" ".(($_SESSION['rsmafterbt']=='0')?"selected":"").">停用</option>\n";$_feat_airplay=$_SESSION['feat_bitmask']&FEAT_AIRPLAY?'':'hide';$_SESSION['airplaysvc']=='1'?$_airplay_btn_disable='':$_airplay_btn_disable='disabled';$_SESSION['airplaysvc']=='1'?$_airplay_link_disable='':$_airplay_link_disable='onclick="return false;"';$_select['airplaysvc1'].="<input type=\"radio\" name=\"airplaysvc\" id=\"toggleairplaysvc1\" value=\"1\" ".(($_SESSION['airplaysvc']==1)?"checked=\"checked\"":"").">\n";$_select['airplaysvc0'].="<input type=\"radio\" name=\"airplaysvc\" id=\"toggleairplaysvc2\" value=\"0\" ".(($_SESSION['airplaysvc']==0)?"checked=\"checked\"":"").">\n";$_select['airplayname']=$_SESSION['airplayname'];$_select['rsmafterapl'].="<option value=\"Yes\" ".(($_SESSION['rsmafterapl']=='Yes')?"selected":"").">启用</option>\n";$_select['rsmafterapl'].="<option value=\"No\" ".(($_SESSION['rsmafterapl']=='No')?"selected":"").">停用</option>\n";$_feat_spotify=$_SESSION['feat_bitmask']&FEAT_SPOTIFY?'':'hide';$_SESSION['spotifysvc']=='1'?$_spotify_btn_disable='':$_spotify_btn_disable='disabled';$_SESSION['spotifysvc']=='1'?$_spotify_link_disable='':$_spotify_link_disable='onclick="return false;"';$_select['spotifysvc1'].="<input type=\"radio\" name=\"spotifysvc\" id=\"togglespotifysvc1\" value=\"1\" ".(($_SESSION['spotifysvc']==1)?"checked=\"checked\"":"").">\n";$_select['spotifysvc0'].="<input type=\"radio\" name=\"spotifysvc\" id=\"togglespotifysvc2\" value=\"0\" ".(($_SESSION['spotifysvc']==0)?"checked=\"checked\"":"").">\n";$_select['spotifyname']=$_SESSION['spotifyname'];$_select['rsmafterspot'].="<option value=\"Yes\" ".(($_SESSION['rsmafterspot']=='Yes')?"selected":"").">启用</option>\n";$_select['rsmafterspot'].="<option value=\"No\" ".(($_SESSION['rsmafterspot']=='No')?"selected":"").">停用</option>\n";$_feat_squeezelite=$_SESSION['feat_bitmask']&FEAT_SQUEEZELITE?'':'hide';$_SESSION['slsvc']=='1'?$_sl_btn_disable='':$_sl_btn_disable='disabled';$_SESSION['slsvc']=='1'?$_sl_link_disable='':$_sl_link_disable='onclick="return false;"';$_select['slsvc1'].="<input type=\"radio\" name=\"slsvc\" id=\"toggleslsvc1\" value=\"1\" ".(($_SESSION['slsvc']==1)?"checked=\"checked\"":"").">\n";$_select['slsvc0'].="<input type=\"radio\" name=\"slsvc\" id=\"toggleslsvc2\" value=\"0\" ".(($_SESSION['slsvc']==0)?"checked=\"checked\"":"").">\n";$_select['rsmaftersl'].="<option value=\"Yes\" ".(($_SESSION['rsmaftersl']=='Yes')?"selected":"").">启用</option>\n";$_select['rsmaftersl'].="<option value=\"No\" ".(($_SESSION['rsmaftersl']=='No')?"selected":"").">停用</option>\n";$_feat_upmpdcli=$_SESSION['feat_bitmask']&FEAT_UPMPDCLI?'':'hide';$_SESSION['upnpsvc']=='1'?$_upnp_btn_disable='':$_upnp_btn_disable='disabled';$_SESSION['upnpsvc']=='1'?$_upnp_link_disable='':$_upnp_link_disable='onclick="return false;"';$_select['upnpsvc1'].="<input type=\"radio\" name=\"upnpsvc\" id=\"toggleupnpsvc1\" value=\"1\" ".(($_SESSION['upnpsvc']==1)?"checked=\"checked\"":"").">\n";$_select['upnpsvc0'].="<input type=\"radio\" name=\"upnpsvc\" id=\"toggleupnpsvc2\" value=\"0\" ".(($_SESSION['upnpsvc']==0)?"checked=\"checked\"":"").">\n";$_select['upnpname']=$_SESSION['upnpname'];$_feat_minidlna=$_SESSION['feat_bitmask']&FEAT_MINIDLNA?'':'hide';$_SESSION['dlnasvc']=='1'?$_dlna_btn_disable='':$_dlna_btn_disable='disabled';$_SESSION['dlnasvc']=='1'?$_dlna_link_disable='':$_dlna_link_disable='onclick="return false;"';$_select['dlnasvc1'].="<input type=\"radio\" name=\"dlnasvc\" id=\"toggledlnasvc1\" value=\"1\" ".(($_SESSION['dlnasvc']==1)?"checked=\"checked\"":"").">\n";$_select['dlnasvc0'].="<input type=\"radio\" name=\"dlnasvc\" id=\"toggledlnasvc2\" value=\"0\" ".(($_SESSION['dlnasvc']==0)?"checked=\"checked\"":"").">\n";$_select['dlnaname']=$_SESSION['dlnaname'];$_select['hostip']=getHostIp();$_feat_djmount=$_SESSION['feat_bitmask']&FEAT_DJMOUNT?'':'hide';$_SESSION['upnp_browser']=='1'?$_djmount_btn_disable='':$_djmount_btn_disable='disabled';$_SESSION['upnp_browser']=='1'?$_djmount_link_disable='':$_djmount_link_disable='onclick="return false;"';$_select['upnp_browser1'].="<input type=\"radio\" name=\"upnp_browser\" id=\"toggle_upnp_browser1\" value=\"1\" ".(($_SESSION['upnp_browser']==1)?"checked=\"checked\"":"").">\n";$_select['upnp_browser0'].="<input type=\"radio\" name=\"upnp_browser\" id=\"toggle_upnp_browser2\" value=\"0\" ".(($_SESSION['upnp_browser']==0)?"checked=\"checked\"":"").">\n";$_feat_mpdas=$_SESSION['feat_bitmask']&FEAT_MPDAS?'':'hide';$_select['mpdassvc1'].="<input type=\"radio\" name=\"mpdassvc\" id=\"togglempdassvc1\" value=\"1\" ".(($_SESSION['mpdassvc']==1)?"checked=\"checked\"":"").">\n";$_select['mpdassvc0'].="<input type=\"radio\" name=\"mpdassvc\" id=\"togglempdassvc2\" value=\"0\" ".(($_SESSION['mpdassvc']==0)?"checked=\"checked\"":"").">\n";$_select['mpdasuser']=$_SESSION['mpdasuser'];$_select['mpdaspwd']=$_SESSION['mpdaspwd'];waitWorker(1,'snd-config');$tpl="snd-config.html";$section=basename(__FILE__,'.php');storeBackLink($section,$tpl);include('/var/local/www/header.php');eval("echoTemplate(\"".getTemplate("templates/$tpl")."\");");include('footer.php');
